# μ „λµ ν¨ν„΄ (Strategy Pattern)

## κ°λ…
μ „λµ ν¨ν„΄μ€ μ‹¤ν–‰ μ¤‘μ— μ•κ³ λ¦¬μ¦μ λ™μ‘μ„ μ„ νƒν•  μ μκ² ν•λ” ν–‰λ™ ν¨ν„΄μ…λ‹λ‹¤. λ™μΌν• λ©μ μ„ λ‹¬μ„±ν•λ” μ—¬λ¬ κ°€μ§€ λ°©λ²•(μ•κ³ λ¦¬μ¦)μ„ μ •μν•κ³ , λ°νƒ€μ„μ— μ μ ν• μ „λµμ„ μ„ νƒν•μ—¬ μ‚¬μ©ν•  μ μμµλ‹λ‹¤.

## μ–Έμ  μ‚¬μ©ν•λ©΄ ν¨κ³Όμ μΈκ°€?
- μ΅°κ±΄λ¬Έ(if-else, switch)μΌλ΅ μ•κ³ λ¦¬μ¦μ„ μ„ νƒν•λ” μ½”λ“λ¥Ό κ°μ„ ν•κ³  μ‹¶μ„ λ•
- λ°νƒ€μ„μ— μ•κ³ λ¦¬μ¦μ„ λ™μ μΌλ΅ λ³€κ²½ν•΄μ•Ό ν•  λ•

## μ£Όμν•΄μ•Ό ν•  μ 
- μ „λµμ΄ λ§μ•„μ§ κ²½μ° ν΄λμ¤ μκ°€ μ¦κ°€
- ν΄λΌμ΄μ–ΈνΈκ°€ μ „λµμ μ°¨μ΄μ μ„ μ•μ•„μ•Ό ν•¨
- κ°„λ‹¨ν• μ•κ³ λ¦¬μ¦μ κ²½μ° μ¤λ²„μ—”μ§€λ‹μ–΄λ§μ΄ λ  μ μμ

## μλ°” μμ‹ μ½”λ“

### 1. κ²°μ  μ‹μ¤ν… μμ‹
```java
// μ „λµ μΈν„°νμ΄μ¤
interface PaymentStrategy {
    void pay(double amount);
    String getPaymentType();
    boolean isAvailable();
}

// κµ¬μ²΄μ μΈ μ „λµλ“¤
class CreditCardPayment implements PaymentStrategy {
    private String cardNumber;
    private String holderName;
    
    public CreditCardPayment(String cardNumber, String holderName) {
        this.cardNumber = cardNumber;
        this.holderName = holderName;
    }
    
    @Override
    public void pay(double amount) {
        System.out.printf("π’³ μ‹ μ©μΉ΄λ“λ΅ $%.2f κ²°μ ν–μµλ‹λ‹¤.\n", amount);
        System.out.printf("μΉ΄λ“ μ†μ μ: %s\n", holderName);
    }
    
    @Override
    public String getPaymentType() {
        return "μ‹ μ©μΉ΄λ“";
    }
    
    @Override
    public boolean isAvailable() {
        return cardNumber != null && cardNumber.length() == 16;
    }
}

class PayPalPayment implements PaymentStrategy {
    private String email;
    
    public PayPalPayment(String email) {
        this.email = email;
    }
    
    @Override
    public void pay(double amount) {
        System.out.printf("π’° PayPalλ΅ $%.2f κ²°μ ν–μµλ‹λ‹¤.\n", amount);
        System.out.printf("κ³„μ •: %s\n", email);
    }
    
    @Override
    public String getPaymentType() {
        return "PayPal";
    }
    
    @Override
    public boolean isAvailable() {
        return email != null && email.contains("@");
    }
}

// μ»¨ν…μ¤νΈ ν΄λμ¤
class PaymentContext {
    private PaymentStrategy paymentStrategy;
    
    public void setPaymentStrategy(PaymentStrategy paymentStrategy) {
        this.paymentStrategy = paymentStrategy;
    }
    
    public void processPayment(double amount) {
        if (paymentStrategy == null) {
            System.out.println("β κ²°μ  λ°©λ²•μ΄ μ„ νƒλμ§€ μ•μ•μµλ‹λ‹¤.");
            return;
        }
        
        if (!paymentStrategy.isAvailable()) {
            System.out.println("β μ„ νƒλ κ²°μ  λ°©λ²•μ„ μ‚¬μ©ν•  μ μ—†μµλ‹λ‹¤.");
            return;
        }
        
        System.out.printf("=== %s κ²°μ  μ²λ¦¬ μ‹μ‘ ===\n", paymentStrategy.getPaymentType());
        paymentStrategy.pay(amount);
        System.out.println("β… κ²°μ κ°€ μ™„λ£λμ—μµλ‹λ‹¤.\n");
    }
}

// ν΄λΌμ΄μ–ΈνΈ μ½”λ“
public class PaymentStrategyExample {
    public static void main(String[] args) {
        PaymentContext paymentContext = new PaymentContext();
        
        PaymentStrategy creditCard = new CreditCardPayment("1234567890123456", "κΉ€μ² μ");
        PaymentStrategy paypal = new PayPalPayment("user@example.com");
        
        double orderAmount = 299.99;
        
        // μ‹ μ©μΉ΄λ“λ΅ κ²°μ 
        paymentContext.setPaymentStrategy(creditCard);
        paymentContext.processPayment(orderAmount);
        
        // PayPalλ΅ κ²°μ 
        paymentContext.setPaymentStrategy(paypal);
        paymentContext.processPayment(orderAmount);
    }
}
```

### 2. ν• μΈ μ •μ±… μμ‹
```java
import java.time.DayOfWeek;
import java.time.LocalDateTime;

// ν• μΈ μ „λµ μΈν„°νμ΄μ¤
interface DiscountStrategy {
    double applyDiscount(double originalPrice);
    String getDiscountDescription();
    boolean isApplicable(Customer customer, LocalDateTime dateTime);
}

// κ³ κ° μ •λ³΄ ν΄λμ¤
class Customer {
    private String id;
    private String membershipLevel;
    private int age;
    private boolean isStudent;
    
    public Customer(String id, String membershipLevel, int age, boolean isStudent) {
        this.id = id;
        this.membershipLevel = membershipLevel;
        this.age = age;
        this.isStudent = isStudent;
    }
    
    // getters
    public String getId() { return id; }
    public String getMembershipLevel() { return membershipLevel; }
    public int getAge() { return age; }
    public boolean isStudent() { return isStudent; }
}

// κµ¬μ²΄μ μΈ ν• μΈ μ „λµλ“¤
class VipDiscountStrategy implements DiscountStrategy {
    @Override
    public double applyDiscount(double originalPrice) {
        return originalPrice * 0.8; // 20% ν• μΈ
    }
    
    @Override
    public String getDiscountDescription() {
        return "VIP ν• μΈ 20%";
    }
    
    @Override
    public boolean isApplicable(Customer customer, LocalDateTime dateTime) {
        return customer.getMembershipLevel().equals("GOLD") || 
               customer.getMembershipLevel().equals("PLATINUM");
    }
}

class StudentDiscountStrategy implements DiscountStrategy {
    @Override
    public double applyDiscount(double originalPrice) {
        return originalPrice * 0.85; // 15% ν• μΈ
    }
    
    @Override
    public String getDiscountDescription() {
        return "ν•™μƒ ν• μΈ 15%";
    }
    
    @Override
    public boolean isApplicable(Customer customer, LocalDateTime dateTime) {
        return customer.isStudent();
    }
}

// ν΄λΌμ΄μ–ΈνΈ μ½”λ“
public class DiscountStrategyExample {
    public static void main(String[] args) {
        Customer goldCustomer = new Customer("C002", "GOLD", 45, false);
        Customer studentCustomer = new Customer("C003", "SILVER", 22, true);
        
        DiscountStrategy vipStrategy = new VipDiscountStrategy();
        DiscountStrategy studentStrategy = new StudentDiscountStrategy();
        
        double originalPrice = 100.0;
        LocalDateTime now = LocalDateTime.now();
        
        // VIP ν• μΈ μ μ©
        if (vipStrategy.isApplicable(goldCustomer, now)) {
            double finalPrice = vipStrategy.applyDiscount(originalPrice);
            System.out.printf("VIP ν• μΈ μ μ©: $%.2f -> $%.2f\n", originalPrice, finalPrice);
        }
        
        // ν•™μƒ ν• μΈ μ μ©
        if (studentStrategy.isApplicable(studentCustomer, now)) {
            double finalPrice = studentStrategy.applyDiscount(originalPrice);
            System.out.printf("ν•™μƒ ν• μΈ μ μ©: $%.2f -> $%.2f\n", originalPrice, finalPrice);
        }
    }
}
```

## Springμ—μ„μ ν™μ©
μ¤ν”„λ§μ—μ„λ” μ „λµ ν¨ν„΄μ„ λ‹¤μ–‘ν• λ°©λ²•μΌλ΅ ν™μ©ν•  μ μμµλ‹λ‹¤:

```java
// 1. @Qualifierλ¥Ό μ΄μ©ν• μ „λµ μ„ νƒ
@Component("creditCardPayment")
public class CreditCardPaymentStrategy implements PaymentStrategy {
    @Override
    public void processPayment(double amount) {
        System.out.println("μ‹ μ©μΉ΄λ“ κ²°μ  μ²λ¦¬: " + amount);
    }
}

@Service
public class PaymentService {
    
    @Autowired
    @Qualifier("creditCardPayment")
    private PaymentStrategy creditCardStrategy;
    
    public void processPayment(String paymentType, double amount) {
        PaymentStrategy strategy = selectStrategy(paymentType);
        strategy.processPayment(amount);
    }
    
    private PaymentStrategy selectStrategy(String type) {
        return switch (type) {
            case "CREDIT_CARD" -> creditCardStrategy;
            default -> throw new IllegalArgumentException("μ§€μ›ν•μ§€ μ•λ” κ²°μ  λ°©μ‹");
        };
    }
}

// 2. Mapμ„ μ΄μ©ν• μ „λµ κ΄€λ¦¬
@Service
public class NotificationService {
    
    private final Map<String, NotificationStrategy> strategies;
    
    public NotificationService(List<NotificationStrategy> strategyList) {
        this.strategies = strategyList.stream()
            .collect(Collectors.toMap(
                NotificationStrategy::getType,
                Function.identity()
            ));
    }
    
    public void sendNotification(String type, String message) {
        NotificationStrategy strategy = strategies.get(type);
        if (strategy != null) {
            strategy.send(message);
        }
    }
}
```

μ „λµ ν¨ν„΄μ€ μ¤ν”„λ§μ μμ΅΄μ„± μ£Όμ…κ³Ό ν•¨κ» μ‚¬μ©ν•λ©΄ λ”μ± κ°•λ ¥ν•κ³  μ μ—°ν• μ‹μ¤ν…μ„ κµ¬μ¶•ν•  μ μμµλ‹λ‹¤.
